#######Bài t???p Chýõng 2#######
#BT1: S??? d???ng hàm c, t???o m???t bi???n ch???a các giá tr??? ð??? dài c???a b???y con v???t. Ð???ng th???i t???o m???t bi???n ch???a các giá tr??? Tb (bao g???m c??? NAs). Chi???u dài trung b??nh c???a b???y con v???t là bao nhiêu?
LengthCT <- c(75, 85, 91.6, 95, NA, 105.5, 106)
Tb <- c(0, 0, 1, NA, 0, 0, 0)
mean(LengthCT, na.rm = TRUE)
#BT2: S??? d???ng l???nh cbind ð??? k???t h???p d??? li???u tháng, ð??? dài và Tb, và lýu tr??? k???t qu??? trong bi???n Boar. Ð???m b???o r???ng b???n có th??? trích xu???t các hàng, c???t và các ph???n t??? c???a Boar. S??? d???ng các hàm dim, nrow và ncol ð??? xác ð???nh s??? lý???ng ð???ng v???t và các bi???n trong Boar
Farm <- c("MO", "MO", "MO", "MO", "LN", "SE", "QM")
Month <- c(11, 7, 7, NA, 9, 9, 11)
Boar <- cbind(Month, LengthCT, Tb)
dim(Boar)
nrow(Boar)
ncol(Boar)
Boar
#BT3: Chúng ta ti???p t???c v???i hýõu t??? bài 1. Thay v?? hàm c mà b???n ð?? s??? d???ng trong bài 2 ð??? k???t h???p d??? li???u Tb. B???n có th??? làm týõng t??? v???i hàm vectõ không? Ð???t tên khác cho vectõ, ch???ng h???n nhý Tb2.
Tb2 <- vector(length = 7)
Tb2[1] = 0
Tb2[2] = 0
Tb2[3] = 1
Tb2[4] = NA
Tb2[5] = 0
Tb2[6] = 0
Tb2[7] = 0
cbind(Month, LengthCT, Tb2)
#BT 4: T???o m???t ma tr???n sau R và xác ð???nh chuy???n v???, ngh???ch ð???o c???a nó và b???i v???i ngh???ch ð???o c???a chính nó.
D <- as.matrix(cbind(c(1, 2, 3), c(4, 2, 1), c(2, 3, 0)))
D
##chuy???n v??? 
t(D)
##ngh???ch ð???o
solve(D)
##b???i v???i ngh???ch ð???o
D%*%solve(D)
#BT 5: H??y t???o m???t data frame ch???a t???t c??? các d??? li???u ðý???c tr??nh bày trong b???ng ??? bài 1. Gi??? s??? r???ng b???n quy???t ð???nh b??nh phýõng d??? li???u ð??? dài. Thêm d??? li???u ðó vào data frame. Làm bài t???p týõng t??? v???i list thay v?? data.frame.
df <- data.frame(
  Farm,
  Month,
  Year <- c(00, 00, 01, NA, 03, 03, 02),
  Sex <- c(1, 2, 2, 2, 1, 2, 2),
  LengthClass <- c(1, 1, 1, 1, 1, 1, 1),
  LengthCT,
  Ecervi <- c(0, 0, 0, NA, 0, 0, 0),
  Tb,
  LengthCT_Square <- LengthCT*LengthCT
)
df
#BT 6: Nh???p d??? li???u vào R trý???c tiên b???ng cách s??? d???ng hàm read.table và sau ðó là hàm scan. S??? d???ng hai tên khác nhau ð??? lýu tr??? d??? li???u. S??? khác bi???t gi???a hai hàm là g??? S??? d???ng các hàm is.matrix và is.data.frame ð??? tr??? l???i câu h???i này.
library(readxl)
ISIT <- read_excel("C:/Users/LENOVO/Downloads/ISIT.xls")
View(ISIT)
is.matrix(ISIT)
is.data.frame(ISIT)
#scan 
ISIT <- scan("C:/Users/LENOVO/Downloads/ISIT.xls",what = "numeric", dec = ".")
is.matrix(ISIT)
is.data.frame(ISIT)
#Hàm read s??? tr??? v??? k???t qu??? là m???t ma tr???n v???i các c???t, hàng c??? r?? ràng gi???ng v???i d??? li???u g???c. 
#C??n scan s??? tr??? v??? k???t qu??? là m???t vector ðý???c ð???c theo t???ng d??ng
#Bài 7: S??? d???ng hàm read.table và scan  s??? d???ng d??? li???u d???ch t??? h???c:
#T???p Deer.xls ch???a d??? li???u v??? hýõu ðý???c th???o lu???n trong Bài t???p 1, nhýng bao g???m t???t c??? các loài ð???ng v???t. 
#Xu???t d??? li???u trong t???p Excel sang t???p ascii và nh???p d??? li???u ðó vào R.
Deer <- read.delim("C:/Users/LENOVO/Downloads/RBook/RBook/Deer.txt", header=FALSE)
View(Deer)
#Lýu d??? li???u sang file ascii
save(Deer, file="DeerASCII.txt",ascii = TRUE)
Deerascii<-read.table("DeerASCII.txt",header=TRUE)
Deerascii
#########Bài t???p chýõng 3########
#BT1: T???p BirdFlu.xls ch???a s??? trý???ng h???p xác nh???n hàng nãm v??? cúm gia c???m A(H5N1) ??? ngý???i t??? m???t s??? qu???c gia ð?? báo cáo cho t??? ch???c y t??? th??? gi???i (WHO). In s??? ca m???c cúm gia c???m nãm 2003. T???ng s??? ca m???c cúm gia c???m nãm 2003 và nãm 2005 là bao nhiêu? Qu???c gia nào ð?? có nhi???u trý???ng h???p nh???t? Qu???c gia nào có ít ca t??? vong do cúm gia c???m nh???t? Cho bi???t t???ng s??? ca m???c cúm gia c???m c???a m???i qu???c gia là bao nhiêu? T???ng s??? v??? m???i nãm là bao nhiêu?
BF <- read_excel("C:/Users/LENOVO/Downloads/BirdFlu.xls")
View(BF)
# In s??? ca m???c cúm gia c???m nãm 2003.
data.frame(BF$Country, BF$cases...2)
# T???ng s??? ca m???c cúm gia c???m nãm 2003 và t???ng s??? nãm 2005
sum(BF$cases...2)
sum(BF$cases...6)
#Thêm c???t t???ng s??? ca t??? vong và s??? trý???ng h???p m???c cúm gia c???m
BF$Total.Cases<-BF$cases...2 + BF$cases...4 + BF$cases...6 + BF$cases...8 + BF$cases...10 + BF$cases...12
BF$Total.Deaths<- BF$deaths...3 + BF$deaths...5 + BF$deaths...7 + BF$deaths...9 + BF$deaths...11 + BF$deaths...13
# Qu???c gia nào ð?? có nhi???u trý???ng h???p m???c b???nh nh???t? 
BF[BF$Total.Cases == max(BF$Total.Cases), ]$Country
# Qu???c gia nào có ít ca t??? vong do cúm gia c???m nh???t?
BF[BF$Total.Deaths == min(BF$Total.Deaths), ]$Country
#T???ng s??? ca m???c cúm gia c???m c???a m???i qu???c gia
data.frame(BF$Country, BF$Total.Cases)
#T???ng s??? ca m???c m???i nãm
df<-data.frame(c(2003, 2004, 2005, 2006, 2007, 2008), 
               c(sum(BF$cases...2), sum(BF$cases...4), sum(BF$cases...6), sum(BF$cases...8), sum(BF$cases...10), sum(BF$cases...12)))
names(df)<- c("Year", "Case")
df
#BT2: #T???p ISIT.xls. Trong R, trích xu???t d??? li???u t??? tr???m 1. Có bao nhiêu quan sát ðý???c t???i tr???m này? 
#Ð??? sâu l???y m???u t???i thi???u, trung v???, trung b??nh và t???i ða t???i tr???m 1 là bao nhiêu?
#Ð??? sâu l???y m???u t???i thi???u, trung v???, trung b??nh và t???i ða t???i tr???m 2 là bao nhiêu? ??? tr???m 3? 
#Xác ð???nh b???t k??? tr???m nào có ít quan sát hõn ðáng k???. T???o m???t khung d??? li???u m???i b??? qua các tr???m này. 
#Trích xu???t d??? li???u t??? nãm 2002. Trích xu???t d??? li???u t??? tháng 4 (c???a t???t c??? các nãm).
#Trích xu???t d??? li???u ðý???c ðo ??? ð??? sâu hõn 2000 mét (t??? t???t c??? các nãm và tháng). 
#Hi???n th??? d??? li???u theo giá tr??? ð??? sâu tãng d???n.
#Hi???n th??? d??? li???u ðý???c ðo ??? ð??? sâu hõn 2000 mét vào tháng Tý.
ISIT <- read.delim("C:/Users/LENOVO/Downloads/RBook/RBook/ISIT.txt")
View(ISIT)
#Trích xu???t d??? li???u t??? tr???m 1
str(ISIT)
#D??? li???u station1
ISIT.Station1 <- ISIT[ISIT$Station ==1,]
ISIT.Station1
names(ISIT.Station1)
str(ISIT.Station1)
# S??? quan sát ðý???c th???c hi???n
nrow(ISIT.Station1)
# minimum, median, mean, maximum ð??? sâu l???y m???u
# Station 1
min(ISIT.Station1$SampleDepth)
median(ISIT.Station1$SampleDepth)
mean(ISIT.Station1$SampleDepth)
max(ISIT.Station1$SampleDepth)
# Station 2
ISIT.Station2 <- ISIT[ISIT$Station ==2,]
nrow(ISIT.Station2)
min(ISIT.Station2$SampleDepth)
median(ISIT.Station2$SampleDepth)
mean(ISIT.Station2$SampleDepth)
max(ISIT.Station2$SampleDepth)
# Station 3
ISIT.Station3 <- ISIT[ISIT$Station ==3,]
nrow(ISIT.Station3)
min(ISIT.Station3$SampleDepth)
median(ISIT.Station3$SampleDepth)
mean(ISIT.Station3$SampleDepth)
max(ISIT.Station3$SampleDepth)
#Ki???m tra station nào ít hon
tapply(ISIT$Station, INDEX = ISIT$Station,length)
#T???o dataframe mà lo???i b??? station ít hõn
ISIT2 <- ISIT[ISIT$Station!=4 & ISIT$Station!=5 ,]
ISIT2
#L???y d??? li???u nãm 2002
Year2002 <- ISIT2[ISIT2$Year ==2002,]
#L???y d??? li???u tháng 4 
AllYear <- ISIT2[ISIT2$Month ==4,]
# Trích xu???t d??? li???u ðý???c ðo ??? ð??? sâu l???n hõn 2000 mét
ISIT2Depth2000 <- ISIT2[ISIT2$SampleDepth >2000,]
# Hi???n th??? d??? li???u theo giá tr??? ð??? sâu tãng d???n
I1 <- order(ISIT2Depth2000$SampleDepth)
showdata <-ISIT2Depth2000[I1,]
# Trích xu???t d??? li???u ðý???c ðo ??? ð??? sâu l???n hõn 2000 mét trong tháng 4
E3 <- ISIT2[ISIT2$Month ==4 & ISIT2$SampleDepth >2000,]
#file tài xu???ng b??? l???i, không có nãm và tháng cho t???p d??? li???u nên không th??? ti???n hành code ðý???c 
#BT3: Trong bý???c cu???i cùng c???a bài t???p trý???c, d??? li???u ðo ðý???c ??? ð??? sâu hõn 2000 mét vào tháng 4 ð?? ðý???c trích xu???t. 
#Xu???t nh???ng d??? li???u này sang m???t t???p ascii m???i.
write.table(E3, file="ISITDepth2000April.txt")
#Bài 4.
#S??? d???ng hàm nhân t??? và truy c???p các t???p con c???a khung d??? li???u v???i d??? li???u 
#nghiên c???u bi???n sâu. Các tr???m t??? 1 ð???n 5 ðý???c l???y m???u vào tháng 4 nãm 2001,
#các tr???m t??? 6 ð???n 11 ??? Tháng 8 nãm 2001,các tr???m t??? 12 ð???n 15 vào tháng 3 nãm 
#2002 và các tr???m t??? 16 ð???n 19 vào tháng 10 nãm 2002.
#T???o hai bi???n m???i trong R ð??? xác ð???nh tháng và nãm. 
#Lýu ?? r???ng ðây là nh???ng y???u t???. 
#Th???c hi???n vi???c này b???ng cách thêm các bi???n m???i bên trong khung d??? li???u.
# Bi???n tháng m???i
ISIT$NewMoth <- NA
ISIT$NewMoth[ISIT$Station <=5] <- "April"
ISIT$NewMoth[ISIT$Station > 5 & ISIT$Station<=11] <- "August"
ISIT$NewMoth[ISIT$Station > 11 & ISIT$Station<=15] <- "March"
ISIT$NewMoth[ISIT$Station >= 16 & ISIT$Station<=19] <- "October"
ISIT$NewMoth
ISIT$NewMoth <- factor(ISIT$NewMoth)
# Bi???n tháng m???i
ISIT$NewYear <- NA
ISIT$NewYear[ISIT$Station <=11] <- 2001
ISIT$NewYear[ISIT$Station  >=12 & ISIT$Station<=19] <- 2002
ISIT$NewYear
ISIT$NewYear <- factor(ISIT$NewYear)
############Bài t???p chýõng 4###########
#BT1: Tính toán giá tr??? trung b??nh hàng tháng m???t l???n b???ng cách s??? d???ng d??? li???u t??? t???t c??? các tr???m. K???t qu??? cu???i cùng ph???i là m???t ma tr???n 16 x 12. Ð???ng th???i tính ð??? l???ch chu???n và s??? l???n quan sát m???i tháng
Tem<-read_excel("C:/Users/LENOVO/Downloads/RBook/RBook/Temperature.xls")
View(Tem)
mean<-matrix(nrow = 16, ncol = 12)
std <- matrix(nrow = 16, ncol = 12)
count<- matrix(nrow = 16, ncol = 12)
allyear <- unique(Tem$Year)
for (i in 1:16) {
  year = allyear[i]
  val = Tem[Tem$Year == year,]
  mean[i,] = tapply(val$Temperature,val$Month,mean, na.rm = TRUE)
  std[i,] = tapply(val$Temperature,val$Month, sd, na.rm = TRUE)
  count[i,] = tapply(val$Temperature,val$Month, length)
}
#Ð??? l???ch chu???n c???a nhi???t ð??? m???i tháng t???ng nãm 
std
#S??? l???n quan sát m???i tháng t???ng nãm 
count
#BT4: S??? d???ng d??? li???u trong bài 1, xác ð???nh s??? l???n quan sát trên m???i tr???m. Có bao nhiêu quan sát ðý???c th???c hi???n m???i nãm? Có bao nhiêu quan sát ðý???c th???c hi???n ??? m???i tr???m m???i nãm?
#S??? l???n quan sát trên m???i tr???m
table(Tem$Station)
#S??? quan sát ðý???c th???c hi???n m???i nãm
table(Tem$Year)
#S??? quan sát ðý???c th???c hi???n ??? m???i tr???m theo t???ng nãm
table(Tem$Year, Tem$Station)
#######Bài t???p chýõng 5###########
#BT1:T???o m???t plot c???a TOT_N so v???i D_park. S??? d???ng nh??n thích h???p.Thêm m???t ðý???ng cong làm m???n. T???o l???i plot nhýng s??? d???ng ði???m t??? l??? v???i giá tr??? c???a OLIVE (ði???u này có th??? cho bi???t li???u OLIVE có ???nh hý???ng hay không).
Amphibian_road_Kills <- read_excel("C:/Users/LENOVO/Downloads/RBook/RBook/Amphibian_road_Kills.xls")
View(Amphibian_road_Kills)
plot(x=Amphibian_road_Kills$D.PARK, y=Amphibian_road_Kills$TOT.N, xlab = "Distance to park", ylab = "Number of dead animal")
M.Loess = loess(TOT.N ~ D.PARK, data = Amphibian_road_Kills)
Fit = fitted(M.Loess)
Ord1 = order(Amphibian_road_Kills$D.PARK)
lines(Amphibian_road_Kills$D.PARK[Ord1], Fit[Ord1], lwd = 3, lty = 2)
plot(x = Amphibian_road_Kills$D.PARK, y=Amphibian_road_Kills$TOT.N, cex = 0.5 + 2*Amphibian_road_Kills$OLIVE/max(Amphibian_road_Kills$OLIVE), xlab = "Distance to park", ylab = "Number of dead animals")
lines(Amphibian_road_Kills$D.PARK[Ord1], Fit[Ord1], lwd = 3, lty = 2)
###########Bài t???p chýõng 6########
#BT1: V??? bi???u ð??? d??? li???u nhi???t ð??? theo th???i gian (tháng) cho t???ng tr???m và lýu ð??? th??? dý???i d???ng t???p jpg
TemP<- read_excel("C:/Users/LENOVO/Downloads/RBook/RBook/Temperature.xls")
View(TemP)
AllStations <- unique(TemP$Station)
for (i in 1:30) {
  Station.i = AllStations[i]
  filename = paste(Station.i, ".jpg", sep = "")
  jpeg(file = filename)
  TemP.i = TemP[TemP$Station == Station.i, ]
  temp = tapply(X = TemP.i$Temperature, INDEX = TemP.i$Month, FUN = mean, na.rm = T)
  plot(temp)
  dev.off()
}
#BT2: S??? d???ng ifelse t???o m???t bi???n phân lo???i m???i xác ð???nh nh???ng quan sát t??? ch??? ð??? ãn t???i m???t t??? c??? th???. Th??? ch???y l???i m?? t??? bài 1 ð??? l???p bi???u ð??? thýõng lý???ng gi???a anh ch??? em v???i th???i gian ð???n cùng m???t t??? và và phân lo???i ch??? ð??? ãn.
Owls <- read.delim("C:/Users/LENOVO/Downloads/RBook/RBook/Owls.txt")
View(Owls)
AllNest <- unique(Owls$Nest)
for (i in 1:27) {
  Owls.i = Owls[Owls$Nest == AllNest[i], ]
  filename = paste(AllNest[i], ".jpg", sep = "")
  jpeg(file = filename)
  plot(x = Owls.i$ArrivalTime, y = Owls.i$SiblingNegotiation, col = c("blue", "red")[ifelse(Owls.i$FoodTreatment == "Deprived", 1, 2)])
  legend(x= "right", c("Deprived", "Satiated"), col = c("blue", "red"), pch = 1)
  dev.off()
}
#BT3: Vi???t l???i hàm tính ð??? phong phú và ð??? ða d???ng c???a sinh v???t
RIKZ <- read.delim("C:/Users/LENOVO/Downloads/RBook/RBook/RIKZ.txt", header=FALSE)
View(RIKZ)
RIKZ <- RIKZ[ ,2:76]
Veg <- read.delim("C:/Users/LENOVO/Downloads/RBook/RBook/Vegetation2.txt")
View(Veg)
Veg <- Veg[ ,5:9]
diversity = function(X, Choice = "Shannon") {
  if (Choice == "Richness")
  {
    index <-rowSums(X > 0, na.rm = TRUE)
  } 
  else if (Choice == "Total Abundance")
  {
    index <- rowSums(X, na.rm = TRUE)
  }
  else if (Choice == "Shannon")
  {
    RS <- rowSums(X, na.rm = TRUE) # this gives # animals counted per site.
    Prop <- X/RS # this gives the % of a given species relative to total species per site.
    H <- -rowSums(Prop * log10(Prop), na.rm = TRUE)
    index <- H
  }
  else
  {
    print("Incorrect value, please enter new choice")
    index <- NA
  }
  list(index = index, MyChoice = Choice)
}
diversity(RIKZ, "Shannon")
###########Bài t???p chýõng 7###########
#BT1 :  L???p bi???u ð??? tr??n th??? hi???n t???ng s??? ca t??? vong m???i nãm và m???t bi???u ð??? bi???u th??? s??? ca t??? vong trên m???i qu???c gia.
BirdFluDeaths <- read.delim("C:/Users/LENOVO/Downloads/RBook/RBook/BirdFluDeaths.txt")
View(BirdFluDeaths)
CBF = colSums(BirdFluDeaths[,2:16])
YBF=  rowSums(BirdFluDeaths[,2:16])
pie(CBF, labels = CBF, col = rainbow(length(CBF)),  main="s??? ca t??? vong c???a m???i qu???c gia", clockwise = TRUE, radius = .8)
legend(x = 0.82, y = 0.5, c('Azerbaijan','Bangladesh','Cambodia','China','Djibouti','Egypt','Indonesia','Iraq','LaoPDR','Myanmar','Nigeria','Pakistan','Thailand','Turkey','VietNam'), cex = 0.65, fill = rainbow(length(CBF)))
pie(YBF, labels = YBF, col = rainbow(length(YBF)),  main="S??? ca t??? vong theo t???ng nãm", clockwise = TRUE, radius = .8)
legend(x = 0.82, y = 0.6, c(2003:2008), cex = 0.65, fill = rainbow(length(YBF)))
#BT2: T???o bi???u ð??? thanh theo giá tr??? trung b??nh ???ng v???i t???ng lát c???t và thêm m???t ðý???ng th???ng ð???ng cho l???i tiêu chu???n.
Veg <- read.delim("C:/Users/LENOVO/Downloads/RBook/RBook/Vegetation2.txt")
View(Veg)
mean <- tapply(Veg$R, Veg$Transect, mean)
std<- tapply(Veg$R, Veg$Transect, sd)
len<- tapply(Veg$R, Veg$Transect, length)
Se <- std/sqrt(len)
bar <- barplot(mean, xlab = "Transect", ylab = "Richness", ylim = c(0,20))
arrows(bar, mean, bar, mean + std, lwd = 1.5, angle=90, length=0.1)
box()
#L???p bi???u ð??? trong ðó trung b??nh ðý???c v??? dý???i d???ng ði???m ðen, sai s??? chu???n dý???i d???ng các ðý???ng xung quanh giá tr??? trung b??nh và các d??? li???u quan sát ðý???c th??? hi???n dý???i d???ng d???u ch???m tr???ng.
plot(x=Veg$Transect, y = jitter(Veg$R), pch=1,  xlab = "Transect", ylab = "Richness")
points(1:8, mean, pch = 16, cex = 1.5)
arrows(1:8,mean, 1:8, mean + Se, lwd = 1.5, angle=90, length=0.1)
arrows(1:8, mean, 1:8, mean- Se, lwd = 1.5, angle=90, length=0.1)
#BT3: S??? d???ng s??? li???u v??? th???m th???c v???t trong Bài t???p 2, h??y l???p bi???u ð??? h??nh h???p th??? hi???n s??? phong phú các giá tr???.
boxplot(Veg$R)
#BT4: T???o m???t ô vuông c???a s??? lý???ng k?? sinh trùng (Cý???ng ð???) tùy theo khu v???c, gi???i tính, giai ðo???n ho???c nãm. Th??? các k???t h???p ð??? phát hi???n các týõng tác.
CodP <- read.delim("C:/Users/LENOVO/Downloads/RBook/RBook/CodParasite.txt")
View(CodP)
boxplot(Intensity ~ Area, data = CodP)
boxplot(Intensity ~ Sex, data = CodP)
boxplot(Intensity ~ Year, data = CodP)
boxplot(Intensity ~ Stage, data = CodP)
##Th??? k???t h???p nhi???u y???u t??? ð??? t??m s??? týõng tác
boxplot(Intensity ~ Area*Stage, data = CodP)
#BT5: L???p hai bi???u ð??? ch???m v??? thýõng lý???ng anh ch??? em và th???i gian ð???n.
Owls <- read.delim("C:/Users/LENOVO/Downloads/RBook/RBook/Owls.txt")
View(Owls)
dotchart(Owls$NegPerChick, main = "Negotiation", xlab = "Value of variable", ylab = "Order of the data")
dotchart(Owls$ArrivalTime, main = "Arrival time", xlab = "Value of variable", ylab= "Order of the data")
#L???p bi???u ð??? ch???m hi???n th??? th???i gian ð???n nõi m???i ðêm. Và phân bi???t ch??? ð??? ãn c???a c???a m???i ðêm.
dotchart(Owls$ArrivalTime,
          main = "Arrival time",
          xlab = "Value of variable",
          ylab = "Order of the data",
          groups = ifelse(Owls$FoodTreatment == "Deprived", 1, 2),
          color = ifelse(Owls$FoodTreatment == "Deprived", 1, 2),)
#BT6 : T???o bi???u ð??? ch???m th??? hi???n cý???ng ð??? theo khu v???c, gi???i tính, giai ðo???n, nãm.
dotchart(CodP$Intensity, groups = factor(CodP$Area))
dotchart(CodP$Intensity, groups = factor(CodP$Year))
dotchart(CodP$Intensity, groups = factor(CodP$Sex))
dotchart(CodP$Intensity, groups = factor(CodP$Stage))
#T???o bi???u ð??? ch???m th??? hi???n ð??? sâu theo m???c ð??? ph??? bi???n
dotchart(CodP$Depth, groups = factor(CodP$Prevalence))
         
         